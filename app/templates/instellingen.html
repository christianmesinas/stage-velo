{% extends "base.html" %}

{% block head %}
<!-- ✅ Подключение CSS + базовая стилизация страницы настроек /
     Koppelen van CSS + basisstijl voor de instellingenpagina -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/instellingen.css') }}">
<style>
  .settings-wrapper {
    max-width: 700px;
    margin: 4rem auto;
    padding: 2.5rem;
    background-color: white;
    border-radius: 1rem;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  }

  body.dark-mode .settings-wrapper {
    background-color: #1f1f1f;
    color: #f0f0f0;
  }

  .form-title {
    text-align: center;
    font-weight: bold;
    margin-bottom: 1.5rem;
  }

  .return-button {
    max-width: 700px;
    margin: 2rem auto 0 auto;
    padding-left: 2.5rem;
  }

  .alert {
    animation: fadeIn 0.4s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
{% endblock %}

{% block header %}{% endblock %}

{% block content %}
<!-- ✅ Кнопка возврата на профиль / Terug naar profiel knop -->
<div class="return-button">
  <a href="{{ url_for('routes.profile') }}" class="btn btn-outline-secondary">← Terug naar profiel</a>
</div>

<div class="settings-wrapper">
  <h2 class="form-title">Instellingen</h2>

  <!-- ✅ Показываем флеш-сообщения об успехе / Weergeven van flashberichten -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mb-4">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- ✅ Форма настроек пользователя / Gebruikersinstellingenformulier -->
  <form method="POST" action="{{ url_for('routes.instellingen') }}">
    <div class="mb-3">
      <label for="titel" class="form-label">Aanspreekvorm</label>
      <select class="form-select" id="titel" name="titel" autocomplete="honorific-prefix">
        <option value="" {% if not user.titel %}selected{% endif %}>...</option>
        <option value="heer" {% if user.titel == 'heer' %}selected{% endif %}>Heer</option>
        <option value="vrouw" {% if user.titel == 'vrouw' %}selected{% endif %}>Vrouw</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="voornaam" class="form-label">Voornaam</label>
      <input type="text" class="form-control" id="voornaam" name="voornaam" autocomplete="given-name" value="{{ user.voornaam or '' }}">
    </div>

    <div class="mb-3">
      <label for="achternaam" class="form-label">Achternaam</label>
      <input type="text" class="form-control" id="achternaam" name="achternaam" autocomplete="family-name" value="{{ user.achternaam or '' }}">
    </div>

    <div class="mb-3">
      <label for="telefoonnummer" class="form-label">Telefoonnummer</label>
      <input type="tel" class="form-control" id="telefoonnummer" name="telefoonnummer" autocomplete="tel" value="{{ user.telefoonnummer or '' }}">
    </div>

    <div class="mb-4">
      <label for="email" class="form-label">E-mailadres</label>
      <input type="email" class="form-control" id="email" name="email" autocomplete="email" value="{{ user.email or '' }}">
    </div>

    <!-- ✅ Поле выбора абонемента / Abonnement keuzeveld -->
    <div class="mb-4">
      <label for="abonnement" class="form-label">Abonnement</label>
      <select class="form-select" id="abonnement" name="abonnement">
        <option value="Geen abonnement" {% if user.abonnement == "Geen abonnement" %}selected{% endif %}>Geen abonnement</option>
        <option value="Dagpas" {% if user.abonnement == "Dagpas" %}selected{% endif %}>Dagpas</option>
        <option value="Weekpas" {% if user.abonnement == "Weekpas" %}selected{% endif %}>Weekpas</option>
        <option value="Jaarkaart" {% if user.abonnement == "Jaarkaart" %}selected{% endif %}>Jaarkaart</option>
      </select>
    </div>

    <!-- ✅ Кнопки отправки и отмены / Opslaan en annuleren knoppen -->
    <div class="d-flex justify-content-between">
      <button type="submit" class="btn btn-primary">Opslaan</button>
      <a href="{{ url_for('routes.profile') }}" class="btn btn-secondary">Annuleren</a>
    </div>
  </form>

  <hr class="my-4">

  <!-- ✅ Форма удаления аккаунта / Formulier voor account verwijderen -->
  <form method="POST" action="{{ url_for('routes.delete_account') }}">
    <button type="submit" class="btn btn-danger w-100"
            onclick="return confirm('Weet u zeker dat u uw account permanent wilt verwijderen?')">
      Verwijder account
    </button>
  </form>
</div>
{% endblock %}
